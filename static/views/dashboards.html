<!-- VIEW: DASHBOARDS -->
<section class="view" id="dashboards">
    <div class="tabs-container">
        <div class="tabs-bar-wrapper">
            <div class="tabs-bar" id="dashboard-tabs">
                <!-- Tabs will be added dynamically -->
            </div>
            <button class="btn-create" id="create-dashboard-btn">+ Create</button>
        </div>
        <div class="tabs-content" id="dashboard-content">
            <!-- Empty state - shown when no tabs open -->
            <div class="empty-state-container" id="dashboard-empty-state">
                <div class="empty-state-list" id="dashboard-empty-list">
                    <!-- Will be populated by JS -->
                </div>
                <div class="empty-state">
                    <svg viewBox="0 0 24 24" class="empty-icon" fill="none" stroke="currentColor" stroke-width="1.5">
                        <rect x="3" y="3" width="7" height="7" rx="1"></rect>
                        <rect x="14" y="3" width="7" height="7" rx="1"></rect>
                        <rect x="3" y="14" width="7" height="7" rx="1"></rect>
                        <rect x="14" y="14" width="7" height="7" rx="1"></rect>
                    </svg>
                    <p class="empty-text">No dashboard selected</p>
                    <p class="empty-subtext">Select a dashboard from the list or create a new one</p>
                </div>
            </div>

            <!-- Dashboard view wrapper - shown when a tab is active -->
            <div class="dashboard-view-wrapper" id="dashboard-details" style="display: none;">

                <!-- Metrics View (shown by default) -->
                <div class="dashboard-metrics-view" id="dashboard-metrics-view">
                    <div class="dashboard-header">
                        <div class="dashboard-header-left">
                            <h2 class="dashboard-title" id="metrics-view-title">Dashboard</h2>
                            <p class="dashboard-subtitle" id="metrics-view-subtitle">Overview of your metrics</p>
                        </div>
                        <div class="dashboard-header-right">
                            <div class="member-filter-selector">
                                <button id="metrics-by-member-btn">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                        <circle cx="12" cy="7" r="4"></circle>
                                    </svg>
                                    <span id="metrics-member-btn-text">all</span>
                                    <svg class="dropdown-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <polyline points="6 9 12 15 18 9"></polyline>
                                    </svg>
                                </button>
                                <div class="member-dropdown" id="metrics-member-dropdown" style="display: none;">
                                    <div class="member-dropdown-header">
                                        <span>Filter by Member</span>
                                        <button type="button" class="member-dropdown-close" id="close-metrics-member-dropdown">&times;</button>
                                    </div>
                                    <div class="member-dropdown-list" id="metrics-member-dropdown-list">
                                        <!-- Members will be loaded here -->
                                    </div>
                                </div>
                            </div>
                            <button class="btn btn-secondary btn-small btn-with-icon" id="show-graph-btn">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="18" y1="20" x2="18" y2="10"></line>
                                    <line x1="12" y1="20" x2="12" y2="4"></line>
                                    <line x1="6" y1="20" x2="6" y2="14"></line>
                                </svg>
                                Graph
                            </button>
                            <button class="btn btn-secondary btn-small" id="show-details-btn">Show Details</button>
                        </div>
                    </div>

                    <!-- Metric Cards Grid -->
                    <div class="metrics-grid" id="metrics-grid">
                        <div class="metric-card-placeholder">
                            <p>Loading metrics...</p>
                        </div>
                    </div>

                    <!-- Leaderboard Section -->
                    <div class="dashboard-section">
                        <div class="section-header">
                            <h3 class="section-title">Leaderboard</h3>
                            <span class="section-badge" id="leaderboard-count">0 members</span>
                        </div>
                        <div class="leaderboard-table" id="dashboard-leaderboard">
                            <div class="leaderboard-empty">
                                <p>No submissions yet</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Graph View -->
                <div class="dashboard-graph-view" id="dashboard-graph-view" style="display: none;">
                    <div class="dashboard-header">
                        <div class="dashboard-header-left">
                            <h2 class="dashboard-title" id="graph-view-title">Analytics</h2>
                            <p class="dashboard-subtitle" id="graph-view-subtitle">Historical metrics over time</p>
                        </div>
                        <div class="dashboard-header-right">
                            <button class="btn btn-secondary btn-small" id="hide-graph-btn">← Back to Dashboard</button>
                        </div>
                    </div>

                    <!-- Graph Controls -->
                    <div class="graph-controls">
                        <div class="graph-metric-tabs" id="graph-metric-tabs">
                            <!-- Metric tabs will be populated by JS -->
                        </div>
                        <div class="graph-filter-controls">
                            <div class="member-selector">
                                <button id="by-member-btn">By Member</button>
                                <div class="member-dropdown" id="member-dropdown" style="display: none;">
                                    <div class="member-dropdown-header">
                                        <span>Select Member</span>
                                        <button type="button" class="member-dropdown-close" id="close-member-dropdown">&times;</button>
                                    </div>
                                    <div class="member-dropdown-list" id="member-dropdown-list">
                                        <!-- Members will be loaded here -->
                                    </div>
                                </div>
                            </div>
                            <select class="form-input form-input-small" id="graph-time-range">
                                <option value="4">Last 4 weeks</option>
                                <option value="8" selected>Last 8 weeks</option>
                                <option value="12">Last 12 weeks</option>
                            </select>
                        </div>
                    </div>

                    <!-- Graph Container -->
                    <div class="graph-card">
                        <div class="graph-header">
                            <span class="graph-metric-label" id="graph-metric-label">All Metrics</span>
                            <span class="graph-member-label" id="graph-member-label">All Members</span>
                        </div>
                        <div class="graph-container" id="graph-container">
                            <div class="graph-loading">Loading graph data...</div>
                        </div>
                        <div class="graph-legend" id="graph-legend"></div>
                    </div>
                </div>

                <!-- Details View - FULL WIDTH - NO GRID -->
                <div class="dashboard-details" id="dashboard-details-view" style="display: none;">
                    <div class="details-header-row">
                        <div>
                            <h2 class="template-title" id="dashboard-title">Dashboard</h2>
                            <p class="template-subtitle" id="dashboard-subtitle">Dashboard configuration and member access</p>
                        </div>
                        <button class="btn btn-secondary btn-small" id="hide-details-btn">← Back to Dashboard</button>
                    </div>

                    <div class="card">
                        <div class="card-title">Dashboard Details</div>
                        <div class="detail-row">
                            <span class="detail-label">Dashboard ID</span>
                            <span class="detail-value" id="dashboard-id">-</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Team</span>
                            <span class="detail-value" id="dashboard-team">-</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Owner</span>
                            <span class="detail-value" id="dashboard-owner">-</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Reporting Period</span>
                            <span class="detail-value" id="dashboard-period">-</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Members</span>
                            <span class="detail-value" id="dashboard-members">-</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Status</span>
                            <span class="detail-value" id="dashboard-status">-</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Created</span>
                            <span class="detail-value" id="dashboard-created">-</span>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-title">Metrics</div>
                        <div class="metrics-list" id="dashboard-metrics">
                            <p class="text-muted">No metrics configured</p>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-title">Dashboard URL</div>
                        <div class="detail-row">
                            <span class="detail-label">Public URL</span>
                            <span class="detail-value" id="dashboard-url">-</span>
                        </div>
                        <div class="btn-row">
                            <button class="btn btn-small" id="copy-dashboard-url">Copy URL</button>
                            <button class="btn btn-small btn-secondary" id="view-dashboard-btn">View Dashboard</button>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-title">Member Access</div>
                        <p class="card-subtitle">Share these passcodes with team members so they can access the dashboard.</p>
                        <div class="members-access-list" id="dashboard-members-access">
                            <p class="text-muted">No members with access</p>
                        </div>
                        <div class="btn-row">
                            <button class="btn btn-small btn-secondary" id="sync-members-btn">Sync Members from Team</button>
                        </div>
                    </div>

                    <div class="card card-danger">
                        <div class="card-title">Danger Zone</div>
                        <p class="card-subtitle">Permanently delete this dashboard and all associated data.</p>
                        <button class="btn btn-small btn-danger" id="delete-dashboard-btn">Delete Dashboard</button>
                        <span id="dashboard-action-status" class="action-status"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Create Dashboard Modal -->
    <div class="modal-overlay" id="create-dashboard-modal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Create Dashboard</h3>
                <button class="modal-close" id="close-dashboard-modal">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <form id="create-dashboard-form">
                <div class="form-group">
                    <label class="form-label" for="new-dashboard-name">Dashboard Name</label>
                    <input type="text" id="new-dashboard-name" class="form-input" placeholder="Weekly Team Metrics" required>
                </div>
                <div class="form-group">
                    <div class="form-label-row">
                        <label class="form-label" for="new-dashboard-team">Team ID</label>
                        <button type="button" class="btn-text" id="pick-team-btn">Pick Team</button>
                    </div>
                    <div class="input-with-dropdown">
                        <input type="text" id="new-dashboard-team" class="form-input" placeholder="507f1f77bcf86cd799439011" required>
                        <div class="team-dropdown" id="team-dropdown" style="display: none;">
                            <div class="team-dropdown-header">
                                <span>Select a Team</span>
                                <button type="button" class="token-dropdown-close" id="close-team-dropdown">&times;</button>
                            </div>
                            <div class="team-dropdown-list" id="team-dropdown-list">
                                <!-- Teams will be loaded here -->
                            </div>
                        </div>
                    </div>
                    <p class="form-hint">The team this dashboard is for</p>
                </div>
                <div class="form-group">
                    <label class="form-label" for="new-dashboard-metrics">Metrics (comma separated)</label>
                    <input type="text" id="new-dashboard-metrics" class="form-input" placeholder="sales, calls, meetings" required>
                    <p class="form-hint">Enter metric names separated by commas</p>
                </div>
                <div class="form-group">
                    <div class="form-label-row">
                        <label class="form-label" for="new-dashboard-period">Reporting Period</label>
                        <span class="info-icon" data-tooltip="Daily: Submit every day. Weekly: Submit once per week. Monthly: Submit once per month.">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"></circle>
                                <line x1="12" y1="16" x2="12" y2="12"></line>
                                <line x1="12" y1="8" x2="12.01" y2="8"></line>
                            </svg>
                        </span>
                    </div>
                    <select id="new-dashboard-period" class="form-input">
                        <option value="daily">Daily</option>
                        <option value="weekly" selected>Weekly</option>
                        <option value="monthly">Monthly</option>
                    </select>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" id="cancel-dashboard-btn">Cancel</button>
                    <button type="submit" class="btn" id="submit-dashboard-btn">Create</button>
                </div>
                <p class="modal-status" id="create-dashboard-status"></p>
            </form>
        </div>
    </div>
</section>